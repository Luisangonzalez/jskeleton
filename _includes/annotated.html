  <div id="container">
    <div id="background"></div>

    <ul class="sections">

          <li id="title">
              <div class="annotation">
                  <h1>jskeleton_lite.js</h1>
              </div>
          </li>



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, factory)</span> </span>{
<span class="hljs-pi">    'use strict'</span>;
    <span class="hljs-comment">/*globals require,define */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        define([<span class="hljs-string">'jquery'</span>,
            <span class="hljs-string">'underscore'</span>,
            <span class="hljs-string">'backbone'</span>,
            <span class="hljs-string">'backbone.marionette'</span>
        ], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($, _, Backbone, Marionette)</span> </span>{
            <span class="hljs-keyword">return</span> factory.call(root, root, $, _, Backbone, Marionette);
        });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
        <span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>),
            _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>),
            Backbone = <span class="hljs-built_in">require</span>(<span class="hljs-string">'backbone'</span>);

        Backbone.$ = $;

        <span class="hljs-keyword">var</span> Marionette = <span class="hljs-built_in">require</span>(<span class="hljs-string">'backbone.marionette'</span>),
            Jskeleton = factory(root, $, _, Backbone, Marionette);

        <span class="hljs-built_in">module</span>.exports = Jskeleton;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root !== <span class="hljs-literal">undefined</span>) {
        root.Jskeleton = factory.call(root, root, root.$, root._, root.Backbone, root.Marionette);
    }

})(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, $, _, Backbone, Marionette)</span> </span>{
<span class="hljs-pi">    'use strict'</span>;

    <span class="hljs-comment">/* jshint unused: false */</span>


    <span class="hljs-keyword">var</span> Jskeleton = root.Jskeleton || {};

     <span class="hljs-string">'use strict'</span>;
     <span class="hljs-comment">/*globals Marionette, Jskeleton, _ */</span>
     <span class="hljs-comment">/* jshint unused: false */</span>


     Marionette.Renderer.render = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(template, data)</span> </span>{
         data = data || {};</pre></div></div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>data.enviroment; //_app, channel, _view
data.templateHelpers; //Marionette template helpers view
data.serializedData; //Marionette model/collection serializedData
data.context; //View-controller context</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">if</span> (!template &amp;&amp; template !== <span class="hljs-string">''</span>) {
             <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Marionette.Error({
                 name: <span class="hljs-string">'TemplateNotFoundError'</span>,
                 message: <span class="hljs-string">'Cannot render the template since its false, null or undefined.'</span>
             });
         }

         template = <span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'function'</span> ? template(data) : template;

         template = <span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'string'</span> ? template : <span class="hljs-built_in">String</span>(template);

         <span class="hljs-keyword">var</span> compiler = Jskeleton.htmlBars.compiler,
             DOMHelper = Jskeleton.htmlBars.DOMHelper,
             hooks = Jskeleton.htmlBars.hooks,
             render = Jskeleton.htmlBars.render;</pre></div></div>

        </li>


        <li id="section-3">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>template = templateFunc();</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">var</span> templateSpec = compiler.compileSpec(template, {}),
             templatePreCompiled = compiler.template(templateSpec),
             env = {
                 dom: <span class="hljs-keyword">new</span> DOMHelper(),
                 hooks: hooks,
                 helpers: Jskeleton._helpers,
                 enviroment: data.enviroment <span class="hljs-comment">// for helper access to the enviroments</span>
             },
             scope = hooks.createFreshScope();

         hooks.bindSelf(env, scope, data);</pre></div></div>

        </li>


        <li id="section-4">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>template access: context (view-controller context) , templateHelpers and model serialized data</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">var</span> dom = render(templatePreCompiled, env, scope, {</pre></div></div>

        </li>


        <li id="section-5">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>contextualElement: output</p>

            </div>

            <div class="content"><div class='highlight'><pre>         }).fragment;

         <span class="hljs-keyword">return</span> dom;
     };
        <span class="hljs-string">'use strict'</span>;
        <span class="hljs-comment">/*globals Jskeleton */</span>

        Jskeleton._helpers = {};

        Jskeleton.registerHelper = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, helperFunc)</span> </span>{
            Jskeleton._helpers[name] = helperFunc;
        };


        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeArray</span><span class="hljs-params">(env, array)</span> </span>{
            <span class="hljs-keyword">var</span> out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(array.length);

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = array.length; i &lt; l; i++) {
                out[i] = env.hooks.getValue(array[i]);
            }

            <span class="hljs-keyword">return</span> out;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeObject</span><span class="hljs-params">(env, object)</span> </span>{
            <span class="hljs-keyword">var</span> out = {};

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> object) {
                out[prop] = env.hooks.getValue(object[prop]);
            }

            <span class="hljs-keyword">return</span> out;
        }

        Jskeleton.htmlBars.hooks.invokeHelper = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(morph, env, scope, visitor, _params, _hash, helper, templates, context)</span> </span>{
            <span class="hljs-keyword">var</span> params = normalizeArray(env, _params);
            <span class="hljs-keyword">var</span> hash = normalizeObject(env, _hash);
            <span class="hljs-keyword">return</span> {
                value: helper.call(context, hash, env, params, templates)
            };
        };
         <span class="hljs-string">'use strict'</span>;
         <span class="hljs-comment">/*globals  Jskeleton, _ */</span>
         <span class="hljs-comment">/* jshint unused: false */</span>

         Jskeleton.registerHelper(<span class="hljs-string">'@component'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params, env)</span> </span>{</pre></div></div>

        </li>


        <li id="section-6">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>env.enviroment._app;
env.enviroment.channel;
env.enviroment._view, view-controller</p>

            </div>

            <div class="content"><div class='highlight'><pre>
             params = params || {};

             <span class="hljs-keyword">var</span> componentName = params.name,
                 ComponentClass,
                 component,
                 viewInstance = env.enviroment._view,
                 componentData;

             <span class="hljs-keyword">if</span> (!componentName) {
                 <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un nombre de clase'</span>);
             }</pre></div></div>

        </li>


        <li id="section-7">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>omit component factory name</p>

            </div>

            <div class="content"><div class='highlight'><pre>             componentData = _.omit(params, <span class="hljs-string">'name'</span>);</pre></div></div>

        </li>


        <li id="section-8">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>inject component dependencies</p>

            </div>

            <div class="content"><div class='highlight'><pre>             componentData = _.extend(componentData, {
                 channel: env.enviroment._channel,
                 _app: env.enviroment._app
             });

             component = Jskeleton.factory.new(componentName, componentData);

             <span class="hljs-keyword">if</span> (!component || <span class="hljs-keyword">typeof</span> component !== <span class="hljs-string">'object'</span>) {
                 <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'No se ha podido crear el componente'</span>);
             }

             viewInstance.addComponent(componentName, component);

             <span class="hljs-keyword">return</span> component.render().$el.get(<span class="hljs-number">0</span>);
         });
    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Jskeleton,_ */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-keyword">var</span> Hook = Jskeleton.Hook = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.beforeCallbacks = [];
        <span class="hljs-keyword">this</span>.afterCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };


    Hook.prototype.before = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
        <span class="hljs-keyword">this</span>.beforeCallbacks.push(callback);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.after = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
        <span class="hljs-keyword">this</span>.afterCallbacks.push(callback);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.processBefore = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        _.each(<span class="hljs-keyword">this</span>.beforeCallbacks, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
            callback.apply(self);
        });
        <span class="hljs-keyword">this</span>.beforeCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.processAfter = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        _.each(<span class="hljs-keyword">this</span>.afterCallbacks, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
            callback.apply(self);
        });
        <span class="hljs-keyword">this</span>.afterCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };
    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>
    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-9">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Application object factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> factory = {};</pre></div></div>

        </li>


        <li id="section-10">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Default available factory objects</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.prototypes = {
        Model: Backbone.Model,
        Collection: Backbone.Collection
    };</pre></div></div>

        </li>


        <li id="section-11">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Available singletons objects</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.singletons = {};</pre></div></div>

        </li>


        <li id="section-12">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Adds an object class to the factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.add = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, obj)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.prototypes[key]) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'AlreadyDefinedFactoryObject - '</span> + key);
        }
        <span class="hljs-keyword">this</span>.prototypes[key] = obj;
    };</pre></div></div>

        </li>


        <li id="section-13">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Creates a new object.
Can recieve an object class or a string object factory key.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.new = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, options)</span> </span>{
        options = options || {};

        <span class="hljs-keyword">var</span> FactoryObject;

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'function'</span>) {
            FactoryObject = obj;
        } <span class="hljs-keyword">else</span> {
            FactoryObject = <span class="hljs-keyword">this</span>.prototypes[obj];
        }

        <span class="hljs-keyword">if</span> (!FactoryObject) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'UndefinedFactoryObject - '</span> + obj);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FactoryObject(options);
    };</pre></div></div>

        </li>


        <li id="section-14">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Creates a new singleton object o retrieves the created one</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.singleton = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, options)</span> </span>{
        options = options || {};

        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.singletons[obj]) {
            <span class="hljs-keyword">this</span>.singletons[obj] = <span class="hljs-keyword">this</span>.new(obj, options);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.singletons[obj];
    };</pre></div></div>

        </li>


        <li id="section-15">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Retrieves an Object reference</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.get = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.prototypes[obj]) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'UndefinedFactoryObject - '</span> + obj);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.prototypes[obj];
    };</pre></div></div>

        </li>


        <li id="section-16">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Gets all objects added to the factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.getAll = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.prototypes;
    };


    Jskeleton.factory = factory;
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Jskeleton, Backbone, _ */</span>

    <span class="hljs-comment">/* jshint unused: false */</span>


    <span class="hljs-keyword">var</span> paramsNames = <span class="hljs-regexp">/:\w(\_|\w|\d)*/g</span>;</pre></div></div>

        </li>


        <li id="section-17">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>optionalParam = /((.<em>?))/g,
namedParam = /((\?)?:\w+/g,
splatParam = /\</em>\w+/;
escapeRegExp = /[-{}[]+?.,\\^$|#\s]/g;</p>

            </div>

        </li>


        <li id="section-18">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="router">Router</h2>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.Router = Backbone.Router.extend({
        routes: {},

        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>, <span class="hljs-string">'route'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> route = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>].length) {
                    route += <span class="hljs-string">':'</span> + <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>].join(<span class="hljs-string">':'</span>);
                }
                <span class="hljs-built_in">console</span>.log(route);
            });
        },

        route: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, options, callback)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-19">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>register route with the jskeleton implementation for view-controller and app-workflow</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (options.viewControllerHandler === <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">var</span> routeRegex,
                    handlerName = options.handlerName &amp;&amp; <span class="hljs-keyword">typeof</span> options.handlerName === <span class="hljs-string">'string'</span> ? options.handlerName : <span class="hljs-keyword">this</span>._getHandlerNameFromRoute(routeString),
                    argsNames = <span class="hljs-keyword">this</span>._getRouteParamsNames(routeString),
                    name = options.name;

                <span class="hljs-keyword">if</span> (!_.isRegExp(routeString)) {
                    routeRegex = <span class="hljs-keyword">this</span>._routeToRegExp(routeString);
                }

                <span class="hljs-keyword">if</span> (!callback) {
                    callback = <span class="hljs-keyword">this</span>[name];
                }

                <span class="hljs-keyword">var</span> router = <span class="hljs-keyword">this</span>;

                Backbone.history.route(routeRegex, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fragment)</span> </span>{
                    <span class="hljs-keyword">var</span> args = router._extractParametersAsObject(routeRegex, fragment, argsNames);
                    <span class="hljs-keyword">if</span> (router.execute(callback, args, handlerName) !== <span class="hljs-literal">false</span>) {
                        router.trigger.apply(router, [<span class="hljs-string">'route:'</span> + name].concat(args));
                        router.trigger(<span class="hljs-string">'route'</span>, name, args);
                        Backbone.history.trigger(<span class="hljs-string">'route'</span>, router, name, args);
                    }
                });

            } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-20">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>register a route with the original Backbone.Router.route implementation</p>

            </div>

            <div class="content"><div class='highlight'><pre>                Backbone.Router.prototype.route.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>

        </li>


        <li id="section-21">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>method to replace a route string with the specified params</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _replaceRouteString: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, params)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                splatPattern;

            _.each(params, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, key)</span> </span>{
                routeString = routeString.replace(<span class="hljs-regexp">/:(\w)+/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x)</span> </span>{</pre></div></div>

        </li>


        <li id="section-22">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>remove : character</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    x = x.substr(<span class="hljs-number">1</span>, x.length - <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">return</span> params[x] ? Jskeleton.utils.replaceSpecialChars(<span class="hljs-built_in">String</span>(params[x])) : <span class="hljs-string">''</span>;
                });</pre></div></div>

        </li>


        <li id="section-23">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>find splats</p>

            </div>

            <div class="content"><div class='highlight'><pre>                splatPattern = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"\\*"</span> + key);
                routeString = routeString.replace(splatPattern, value);
            });</pre></div></div>

        </li>


        <li id="section-24">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>replace uncomplete conditionals ex. (:id) and coinditional parenthesis ()</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> routeString.replace(<span class="hljs-regexp">/\(([^\):])*:([^\):])*\)/g</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/\(|\)/g</span>, <span class="hljs-string">''</span>);
        },</pre></div></div>

        </li>


        <li id="section-25">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Cast url string to a default camel case name (commonly to call view-controller method)
ex: ‘/show/details -&gt; onShowDetails’</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getHandlerNameFromRoute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> endPosParams = routeString.indexOf(<span class="hljs-string">':'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">':'</span>),
                endPosOptionals = routeString.indexOf(<span class="hljs-string">'(/'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">'(/'</span>),
                endPosSplats = routeString.indexOf(<span class="hljs-string">'*'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">'*'</span>);

            <span class="hljs-keyword">var</span> replacedString = routeString.substr(<span class="hljs-number">0</span>, <span class="hljs-built_in">Math</span>.min(endPosParams, endPosOptionals, endPosSplats)).replace(<span class="hljs-regexp">/\/(\w|\d)?/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x)</span> </span>{
                    <span class="hljs-keyword">return</span> x.replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">''</span>).toUpperCase();
                }),
                handlerName = <span class="hljs-string">'on'</span> + replacedString.charAt(<span class="hljs-number">0</span>).toUpperCase() + replacedString.slice(<span class="hljs-number">1</span>);

            <span class="hljs-keyword">return</span> handlerName;
        },</pre></div></div>

        </li>


        <li id="section-26">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Execute a route handler with the provided parameters.
Override Backbone.Router.exectue method to provide the
view controller handlerName based on routeString.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        execute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback, args, handlerName)</span> </span>{
            <span class="hljs-keyword">if</span> (callback) {
                callback.call(<span class="hljs-keyword">this</span>, args, handlerName);
            }
        },</pre></div></div>

        </li>


        <li id="section-27">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Execute a route handler with the provided parameters.
return parameters as object</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _extractParametersAsObject: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(route, fragment, argsNames)</span> </span>{
            <span class="hljs-keyword">var</span> params = route.exec(fragment).slice(<span class="hljs-number">1</span>),
                paramsObject = {};

            _.each(params, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(param, i)</span> </span>{
                <span class="hljs-keyword">if</span> (i === params.length - <span class="hljs-number">1</span>) {
                    param = param || <span class="hljs-literal">null</span>;
                } <span class="hljs-keyword">else</span> {
                    param = param ? <span class="hljs-built_in">decodeURIComponent</span>(param) : <span class="hljs-literal">null</span>;
                }

                <span class="hljs-keyword">if</span> (argsNames[i] !== <span class="hljs-literal">undefined</span>) {
                    paramsObject[argsNames[i]] = param;
                }
            });

            <span class="hljs-keyword">return</span> paramsObject;
        },</pre></div></div>

        </li>


        <li id="section-28">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Extracts route params names as array.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getRouteParamsNames: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> name = paramsNames.exec(routeString),
                names = [];

            <span class="hljs-keyword">while</span> (name !== <span class="hljs-literal">null</span>) {
                names.push(name[<span class="hljs-number">0</span>].replace(<span class="hljs-string">':'</span>, <span class="hljs-string">''</span>));
                name = paramsNames.exec(routeString);
            }

            <span class="hljs-keyword">return</span> names;
        },</pre></div></div>

        </li>


        <li id="section-29">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Router initialization.
Bypass all anchor links except those with data-bypass attribute
Starts router history. All routes should be already added</p>

            </div>

            <div class="content"><div class='highlight'><pre>        init: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-30">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Trigger the initial route and enable HTML5 History API support, set the
root folder to ‘/‘ by default.  Change in app.js.</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Backbone.history.start();</pre></div></div>

        </li>


        <li id="section-31">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>log.debug(‘router.location.hash’, window.location.hash.replace(‘#/‘, ‘/‘));
Backbone.history.navigate(window.location.hash.replace(‘#/‘, ‘/‘), true);</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },

        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.init();
        }
    }, {</pre></div></div>

        </li>


        <li id="section-32">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Get singleton instance bject</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getSingleton: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">var</span> instance = <span class="hljs-literal">null</span>;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">if</span> (!instance) {
                    instance = <span class="hljs-keyword">new</span> Jskeleton.Router();
                }
                <span class="hljs-keyword">return</span> instance;
            }

            Jskeleton.router = getInstance();
            <span class="hljs-keyword">return</span> Jskeleton.router;
        },</pre></div></div>

        </li>


        <li id="section-33">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Initialize Backbone.history.start</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app)</span> </span>{
            app.router.init();
        }
    });

    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Marionette, Jskeleton, _ */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-comment">/**
     * Reusable component as a Service
     */</span>
    <span class="hljs-keyword">var</span> Service = Marionette.Object.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(opts)</span> </span>{
            <span class="hljs-keyword">var</span> options = opts || {},</pre></div></div>

        </li>


        <li id="section-34">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Todo serviceOptions ?</p>

            </div>

            <div class="content"><div class='highlight'><pre>                serviceOptions = [<span class="hljs-string">'model'</span>, <span class="hljs-string">'collection'</span>, <span class="hljs-string">'events'</span>];

            _.extend(<span class="hljs-keyword">this</span>, _.pick(options, serviceOptions));

            <span class="hljs-keyword">this</span>.options = _.extend({}, <span class="hljs-keyword">this</span>.options, <span class="hljs-keyword">this</span>.defaults, options);

            <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
                <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
        }

    });

    Jskeleton.Service = Service;

    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-35">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h2 id="baseapplication">BaseApplication</h2>
<p> BaseApplication Class that other <code>Jskeleton.Applications</code> can extend from.
 It contains common application behavior as router/events initialization, application channels set up, common get methods…</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.BaseApplication = Marionette.Application.extend({</pre></div></div>

        </li>


        <li id="section-36">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Default global webapp channel for communicate with other apps</p>

            </div>

            <div class="content"><div class='highlight'><pre>        globalChannel: <span class="hljs-string">'global'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-37">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>generate application id</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.aid = <span class="hljs-keyword">this</span>.getAppId();

            <span class="hljs-keyword">this</span>.router = Jskeleton.Router.getSingleton();

            Marionette.Application.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        },</pre></div></div>

        </li>


        <li id="section-38">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Call to the specified view-controller method for render a app state</p>

            </div>

            <div class="content"><div class='highlight'><pre>        invokeViewControllerRender: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, args, handlerName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-39">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>var hook = this.getHook(),
Get the view controller instance</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> viewController = routeObject._viewController = <span class="hljs-keyword">this</span>._getViewControllerInstance(routeObject);

            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'onNavigate'</span>, viewController);</pre></div></div>

        </li>


        <li id="section-40">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>hook.processBefore();</p>

            </div>

            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> viewController[handlerName] !== <span class="hljs-string">'function'</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El metodo '</span> + handlerName + <span class="hljs-string">' del view controller no existe'</span>);
            }

            viewController[handlerName].call(viewController, args, <span class="hljs-keyword">this</span>.service);
            <span class="hljs-keyword">this</span>._showControllerView(viewController);</pre></div></div>

        </li>


        <li id="section-41">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>hook.processAfter();</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-42">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Show the controller view instance in the application region</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _showControllerView: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(controllerView)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.mainRegion &amp;&amp; <span class="hljs-keyword">this</span>.mainRegion.currentView !== controllerView) {
                <span class="hljs-keyword">this</span>.mainRegion.show(controllerView);
            } <span class="hljs-keyword">else</span> {
                controllerView.render();
            }
        },</pre></div></div>

        </li>


        <li id="section-43">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Factory method to instance objects from Class references</p>

            </div>

            <div class="content"><div class='highlight'><pre>        factory: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Class, options)</span> </span>{
            options = options || {};
            options.parentApp = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class(options);
        },</pre></div></div>

        </li>


        <li id="section-44">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Internal method to create an application private channel and set the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChannel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-45">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>backbone.radio</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.globalChannel = <span class="hljs-keyword">this</span>.globalChannel ? Backbone.Radio.channel(<span class="hljs-keyword">this</span>.globalChannel) : Backbone.Radio.channel(<span class="hljs-string">'global'</span>);
            <span class="hljs-keyword">this</span>.privateChannel = <span class="hljs-keyword">this</span>.privateChannel ? Backbone.Radio.channel(<span class="hljs-keyword">this</span>.privateChannel) : Backbone.Radio.channel(<span class="hljs-keyword">this</span>.aid);
        },</pre></div></div>

        </li>


        <li id="section-46">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Add application routes  to the router and event handlers to the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initRoutes: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>._viewControllers = [];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.routes) {
                _.each(<span class="hljs-keyword">this</span>.routes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, routeName)</span> </span>{
                    routeObject = routeObject || {};</pre></div></div>

        </li>


        <li id="section-47">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>get view controller class object (it could be a view controller class asigned to the route or a default view controller if no class is specified)</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    routeObject._ViewController = self._extendViewControllerClass(routeObject);</pre></div></div>

        </li>


        <li id="section-48">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>extend view controller class with d.i</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    routeObject._viewControllerOptions = _.extend({
                        app: self,
                        channel: self.privateChannel,
                        service: self.service,
                        region: self.region
                    }, routeObject.viewControllerOptions);</pre></div></div>

        </li>


        <li id="section-49">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>add the route handler to Jskeleton.Router</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self._addAppRoute(routeName, routeObject);</pre></div></div>

        </li>


        <li id="section-50">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>add the event handler to the app globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self._addAppEventListener(routeName, routeObject);
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-51">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>        _addAppRoute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

            <span class="hljs-keyword">this</span>.router.route(routeString, {
                viewControllerHandler: <span class="hljs-literal">true</span>,
                triggerEvent: routeObject.triggerEvent,
                handlerName: routeObject.handlerName || <span class="hljs-keyword">this</span>._getViewControllerHandlerName(routeString)
            }, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(args, handlerName)</span> </span>{
                self.invokeViewControllerRender(routeObject, args, handlerName);
            });
        },</pre></div></div>

        </li>


        <li id="section-52">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Add listen to a global event changing the url with the event parameters and calling to the view-controller</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _addAppEventListener: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeObject)</span> </span>{
            <span class="hljs-keyword">if</span> (routeObject.eventListener) {
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    handlerName = routeObject.handlerName || <span class="hljs-keyword">this</span>._getViewControllerHandlerName(routeString);

                <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.globalChannel, routeObject.eventListener, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(args)</span> </span>{
                    <span class="hljs-keyword">if</span> (!routeObject.navigate) {</pre></div></div>

        </li>


        <li id="section-53">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>update the url</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self._navigateTo.call(self, routeString, routeObject, args);
                    }

                    self.invokeViewControllerRender(routeObject, args, handlerName);
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-54">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Update the url with the specified parameters</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _navigateTo: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeOptions, params)</span> </span>{
            <span class="hljs-keyword">var</span> triggerValue = routeOptions.triggerNavigate === <span class="hljs-literal">true</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>,
                processedRoute = <span class="hljs-keyword">this</span>.router._replaceRouteString(routeString, params);

            <span class="hljs-keyword">this</span>.router.navigate(processedRoute, {
                trigger: triggerValue
            });
        },</pre></div></div>

        </li>


        <li id="section-55">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Internal method to retrieve the name of the view-controller method to call before render the view</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getViewControllerHandlerName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> handlerName = <span class="hljs-keyword">this</span>.routes[routeString].handlerName || <span class="hljs-keyword">this</span>.router._getHandlerNameFromRoute(routeString);

            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.routes[routeString].handlerName) {</pre></div></div>

        </li>


        <li id="section-56">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>set the route handler name to the app route object</p>

            </div>

            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.routes[routeString].handlerName = handlerName;
            }

            <span class="hljs-keyword">return</span> handlerName;
        },</pre></div></div>

        </li>


        <li id="section-57">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Extend view controller class for inyect template dependency</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _extendViewControllerClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{

            <span class="hljs-keyword">var</span> template = options.template,
                ViewControllerClass = options.viewControllerClass || <span class="hljs-keyword">this</span>.getDefaultviewController();

            <span class="hljs-keyword">if</span> (!template) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un template'</span>);
            }

            <span class="hljs-keyword">return</span> ViewControllerClass.extend({
                template: template
            });

        },
        _removeViewController: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, viewController)</span> </span>{
            <span class="hljs-keyword">if</span> (routeObject._viewController === viewController) {
                routeObject._viewController = <span class="hljs-literal">undefined</span>;
            }
        },</pre></div></div>

        </li>


        <li id="section-58">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Get a view controller instance (if no view controller is specified, a default view controller class is instantiated).
Ensure that don’t extist a view-controller and if exist that it’s not destroyed</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getViewControllerInstance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                viewController = routeObject._viewController,
                ViewControllerClass = routeObject._ViewController,
                viewControllerOptions = routeObject._viewControllerOptions || {};

            <span class="hljs-keyword">if</span> (!viewController || viewController.isDestroyed === <span class="hljs-literal">true</span>) {
                viewController = <span class="hljs-keyword">this</span>.factory(ViewControllerClass, viewControllerOptions);
                <span class="hljs-keyword">this</span>.listenTo(viewController, <span class="hljs-string">'destroy'</span>, <span class="hljs-keyword">this</span>._removeViewController.bind(<span class="hljs-keyword">this</span>, routeObject, viewController));
            }

            <span class="hljs-keyword">return</span> viewController;
        },</pre></div></div>

        </li>


        <li id="section-59">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Attach application events to the global channel (triggers and listeners)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">var</span> events = options.events || <span class="hljs-keyword">this</span>.events || {};

            <span class="hljs-keyword">this</span>._proxyTriggerEvents(events.triggers);
            <span class="hljs-keyword">this</span>._proxyListenEvents(events.listen);
        },</pre></div></div>

        </li>


        <li id="section-60">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Attach trigger events:
Propagate internal events (application channel) into the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyTriggerEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(triggerArray)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>

        </li>


        <li id="section-61">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Check if triggers are defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (triggerArray &amp;&amp; <span class="hljs-keyword">typeof</span> triggerArray === <span class="hljs-string">'object'</span>) {
                _.each(triggerArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-62">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Listen to the event in the private channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self.listenTo(self.privateChannel, eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">var</span> args;</pre></div></div>

        </li>


        <li id="section-63">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>if the event type is ‘all’, the first argument is the name of the event</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'all'</span>) {
                            eventName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];</pre></div></div>

        </li>


        <li id="section-64">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>casting arguments array-like object to array with excluding the eventName argument</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = [eventName].concat(<span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>));
                        } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-65">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>casting arguments array-like object to array</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
                        }</pre></div></div>

        </li>


        <li id="section-66">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>trigger the event throw the globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self.globalChannel.trigger.apply(self.globalChannel, [eventName].concat(args));
                    });
                });

            }
        },</pre></div></div>

        </li>


        <li id="section-67">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Attach Global events to the private channel:
Propagate external events (global channel) into the private channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyListenEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(listenObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">if</span> (listenObject &amp;&amp; <span class="hljs-keyword">typeof</span> listenObject === <span class="hljs-string">'object'</span>) {
                _.each(listenObject, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-68">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Listen to that event in the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self.listenTo(self.globalChannel, eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">var</span> args;</pre></div></div>

        </li>


        <li id="section-69">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>if the event is ‘all’ the first argument is the name of the event</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'all'</span>) {
                            eventName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];</pre></div></div>

        </li>


        <li id="section-70">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>casting arguments array-like object to array with excluding the eventName argument</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = [eventName].concat(<span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>));
                        } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-71">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>casting arguments array-like object to array</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
                        }</pre></div></div>

        </li>


        <li id="section-72">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>trigger the event throw the globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self.privateChannel.trigger.apply(self.privateChannel, [eventName].concat(args));
                    });
                });
            }
        },
        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>._started = <span class="hljs-literal">true</span>;

            <span class="hljs-keyword">this</span>._initCallbacks.run(options, <span class="hljs-keyword">this</span>);</pre></div></div>

        </li>


        <li id="section-73">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Add routes listeners to the Jskeleton.router</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._initRoutes(options);</pre></div></div>

        </li>


        <li id="section-74">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Add app proxy events</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._proxyEvents(options);
        },
        stop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.stopListening();
        },
        destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.removeRegions();
        },</pre></div></div>

        </li>


        <li id="section-75">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Remove all regions from the application</p>

            </div>

            <div class="content"><div class='highlight'><pre>        removeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-76">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>var self = this;
this._regionManager.each(function(region) {
    self.removeRegion(region);
});</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-77">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Get default application view-controller class if no controller is specified</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getDefaultviewController: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> Jskeleton.ViewController;
        },</pre></div></div>

        </li>


        <li id="section-78">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Get default application layout class if no layoutClass is specified</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getDefaultLayoutClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> Marionette.LayoutView;
        },</pre></div></div>

        </li>


        <li id="section-79">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Factory hook method</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getHook: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Jskeleton.Hook();
        },</pre></div></div>

        </li>


        <li id="section-80">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Generate unique app id using underscore uniqueId method</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getAppId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> _.uniqueId(<span class="hljs-string">'a'</span>);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-81">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <h2 id="application">Application</h2>
<p> Application class is a ‘container’ where to store your webapp logic and split it into small ‘pieces’ and ‘components’.
 It initializes <code>regions, events, routes, channels and child applications</code>.
 It has a global channel to communicate with others apps and a private channel to communicate with it’s components,
 A Jskeleton webapp can contain many Jskeleton.Applications.
 A <code>Jskeleton.Application</code> can define multiple child applications (<code>Jskeleton.ChildApplication</code>).</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.Application = Jskeleton.BaseApplication.extend({</pre></div></div>

        </li>


        <li id="section-82">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Default dom reference (usefull for the first webapp root region)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        defaultEl: <span class="hljs-string">'body'</span>,
        defaultRegion: <span class="hljs-string">'root'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>.rootEl = options.rootEl || <span class="hljs-keyword">this</span>.rootEl || <span class="hljs-keyword">this</span>.defaultEl;

            <span class="hljs-keyword">this</span>._region = options.region || <span class="hljs-keyword">this</span>.defaultRegion;</pre></div></div>

        </li>


        <li id="section-83">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p><code>Jskeleton.BaseApplication</code> constructor</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Jskeleton.BaseApplication.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">this</span>.applications = options.applications || <span class="hljs-keyword">this</span>.applications || {};</pre></div></div>

        </li>


        <li id="section-84">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>private object instances of applications</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._childApps = {};

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

        },</pre></div></div>

        </li>


        <li id="section-85">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Method to start the application, start the <code>ChildApplications</code> and start listening routes/events</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);</pre></div></div>

        </li>


        <li id="section-86">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>init child apps</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._initChildApplications(options);

            Jskeleton.BaseApplication.prototype.start.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-87">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Start the <code>Jskeleton.Router</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.startRouter();
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
        },</pre></div></div>

        </li>


        <li id="section-88">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Method to explicit start a child app instance</p>

            </div>

            <div class="content"><div class='highlight'><pre>        startChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(childApp, options)</span> </span>{
            childApp.start(options);
        },</pre></div></div>

        </li>


        <li id="section-89">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Method to start listening the <code>Backbone.Router</code> (called by a Main Application)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        startRouter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.router.start();
        },</pre></div></div>

        </li>


        <li id="section-90">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Private method to initialize the application regions</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-91">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>ensure initial root DOM reference is available</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._ensureEl();

            Marionette.Application.prototype._initializeRegions.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-92">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Create root region on root DOM reference</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._createRootRegion();</pre></div></div>

        </li>


        <li id="section-93">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>Create a layout for the application if a layoutView its defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._createApplicationLayout();
        },</pre></div></div>

        </li>


        <li id="section-94">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Private method to ensure that the main application has a dom reference where create the root webapp region</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _ensureEl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.$rootEl) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.rootEl) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir una rootEl para la Main App'</span>);
                }
                <span class="hljs-keyword">this</span>.$rootEl = $(<span class="hljs-keyword">this</span>.rootEl);
            }
        },</pre></div></div>

        </li>


        <li id="section-95">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Add the root region to the main application</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _createRootRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._region <span class="hljs-keyword">instanceof</span> Marionette.Region) {</pre></div></div>

        </li>


        <li id="section-96">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>TODO</p>

            </div>

            <div class="content"><div class='highlight'><pre>            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> rootRegion = {};

                rootRegion[<span class="hljs-keyword">this</span>._region] = <span class="hljs-keyword">this</span>.rootEl;

                <span class="hljs-keyword">this</span>.addRegions(rootRegion);
            }
        },</pre></div></div>

        </li>


        <li id="section-97">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Create a layout for the Application to have more regions
Adds the layout regions to the application object as properties</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _createApplicationLayout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-98">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>ensure layout object is defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.layout &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.layout === <span class="hljs-string">'object'</span>) {
                <span class="hljs-keyword">this</span>.layoutTemplate = <span class="hljs-keyword">this</span>.layout.template; <span class="hljs-comment">//TODO: lanzar aserción</span>
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.layoutTemplate) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Si defines un objeto layout tienes que definir un template'</span>);
                }

                <span class="hljs-keyword">this</span>.layoutClass = <span class="hljs-keyword">this</span>.layout.layoutClass || <span class="hljs-keyword">this</span>.getDefaultLayoutClass(); <span class="hljs-comment">//TODO: mirar si poner layout por defecto ( seria necesario entonces poder poner regiones de forma explicita)</span>
                <span class="hljs-keyword">this</span>.layoutClass = <span class="hljs-keyword">this</span>.layoutClass.extend({
                    template: <span class="hljs-keyword">this</span>.layoutTemplate
                });
                <span class="hljs-keyword">this</span>._layout = <span class="hljs-keyword">this</span>.factory(<span class="hljs-keyword">this</span>.layoutClass, <span class="hljs-keyword">this</span>.layout.options);
                <span class="hljs-keyword">this</span>.root.show(<span class="hljs-keyword">this</span>._layout);

                <span class="hljs-keyword">this</span>._addLayoutRegions();
            }
        },</pre></div></div>

        </li>


        <li id="section-99">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Expose layout regions to the application namespace</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _addLayoutRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._layout.regionManager.length &gt; <span class="hljs-number">0</span>) {
                _.each(<span class="hljs-keyword">this</span>._layout.regionManager._regions, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(region, regionName)</span> </span>{
                    self[regionName] = region;
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-100">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>Iterate over child applications to start each one</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChildApplications: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isChildApp) {
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
                _.each(<span class="hljs-keyword">this</span>.applications, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, key)</span> </span>{
                    self._initChildApp(key, value);
                });
                <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'applications:start'</span>);
            }
        },</pre></div></div>

        </li>


        <li id="section-101">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Start child application with it’s dependencies injected</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appName, appOptions)</span> </span>{
            <span class="hljs-keyword">var</span> appClass = appOptions.applicationClass,
                startWithParent = appOptions.startWithParent !== <span class="hljs-literal">undefined</span> ? appOptions.startWithParent : <span class="hljs-literal">true</span>;

            appOptions.region = <span class="hljs-keyword">this</span>._getChildAppRegion(appOptions);

            <span class="hljs-keyword">var</span> instanceOptions = _.omit(appOptions, <span class="hljs-string">'applicationClass'</span>, <span class="hljs-string">'startWithParent'</span>),
                instance = <span class="hljs-keyword">this</span>.factory(appClass, instanceOptions);
            <span class="hljs-keyword">this</span>._childApps[appName] = instance;</pre></div></div>

        </li>


        <li id="section-102">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Start child application</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (startWithParent === <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">this</span>.startChildApp(instance, instanceOptions.startOptions);
            }
        },</pre></div></div>

        </li>


        <li id="section-103">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Get the region where a child application will be rendered when process a route or an event</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getChildAppRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appOptions)</span> </span>{
            <span class="hljs-keyword">var</span> region,
                regionName = appOptions.region || <span class="hljs-keyword">this</span>.defaultRegion;</pre></div></div>

        </li>


        <li id="section-104">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>retrieve the region from the application layout</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._layout &amp;&amp; <span class="hljs-keyword">this</span>._layout.regionManager) {
                region = <span class="hljs-keyword">this</span>._layout.regionManager.get(regionName);
            }</pre></div></div>

        </li>


        <li id="section-105">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>retrieve the region from the application region manager</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (!region) {
                region = <span class="hljs-keyword">this</span>._regionManager.get(regionName);
            }</pre></div></div>

        </li>


        <li id="section-106">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>the region must exists</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (!region) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The region must exists in the Parent application.'</span>);
            }

            <span class="hljs-keyword">return</span> region;
        },</pre></div></div>

        </li>


        <li id="section-107">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Get child app instance by name</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appName)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._childApps[appName];
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-108">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <h2 id="childapplication">ChildApplication</h2>
<p> ChildApplication class is a ‘container’ where to store your webapp logic and split it into small ‘pieces’ and ‘components’.
 It initializes regions, events, routes and channels.
 It cannot contain child applications.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.ChildApplication = Jskeleton.BaseApplication.extend({</pre></div></div>

        </li>


        <li id="section-109">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Default parent region name where the application will be rendered</p>

            </div>

            <div class="content"><div class='highlight'><pre>        defaultRegion: <span class="hljs-string">'root'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-110">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>reference to the parent app</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.parentApp = options.parentApp;

            <span class="hljs-keyword">if</span> (!options.region) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'La child app tiene que tener una region específica'</span>);
            }</pre></div></div>

        </li>


        <li id="section-111">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>Add the injected region as root</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.mainRegion = options.region;</pre></div></div>

        </li>


        <li id="section-112">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Jskeleton.BaseApplication constructor</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Jskeleton.BaseApplication.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>

        </li>


        <li id="section-113">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Method to start the application and listening routes/events</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);

            Jskeleton.BaseApplication.prototype.start.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-114">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>this._initAppEventsListeners(options);</p>

            </div>

            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
        },</pre></div></div>

        </li>


        <li id="section-115">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Private method to initialize de application regions</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-116">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>ensure initial root region is available</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._ensureMainRegion();

            Marionette.Application.prototype._initializeRegions.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-117">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>Create a layout for the application if a layoutView its defined
this._createLayoutApp();</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-118">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>Private method to ensure that parent region exists</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _ensureMainRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.mainRegion || <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.mainRegion.show !== <span class="hljs-string">'function'</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir una region para la Child Application'</span>);
            }
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.View = Marionette.View.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>.channel = options.channel || <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>._app = options.app;

            Marionette.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.ItemView = Marionette.ItemView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            Jskeleton.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton */</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.LayoutView = Marionette.LayoutView.extend({

        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>._firstRender = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>._initializeRegions(options);

            Jskeleton.ItemView.call(<span class="hljs-keyword">this</span>, options);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.CollectionView = Marionette.CollectionView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{

            <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>._initialEvents);

            <span class="hljs-keyword">this</span>._initChildViewStorage();

            Jskeleton.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'show'</span>, <span class="hljs-keyword">this</span>._onShowCalled);

            <span class="hljs-keyword">this</span>.initRenderBuffer();
        },</pre></div></div>

        </li>


        <li id="section-119">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>override Marionette method to inject dependencies (as application channel, application reference …) into child views</p>

            </div>

            <div class="content"><div class='highlight'><pre>        buildChildView: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(child, ChildViewClass, childViewOptions)</span> </span>{
            <span class="hljs-keyword">var</span> options = _.extend({
                model: child,
                channel: <span class="hljs-keyword">this</span>.channel,
                _app: <span class="hljs-keyword">this</span>._app
            }, childViewOptions);


            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ChildViewClass(options);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.CompositeView = Marionette.CompositeView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            Jskeleton.CollectionView.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>);
        }
    });

        <span class="hljs-string">'use strict'</span>;

        <span class="hljs-comment">/*globals Jskeleton, Marionette, _ */</span></pre></div></div>

        </li>


        <li id="section-120">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <h2 id="viewcontroller">ViewController</h2>
<p>The view controller object is an hybrid of View/Controller. It is responsible for render an application
state, build up the application context and render the application components.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        Jskeleton.ViewController = Jskeleton.LayoutView.extend({
            constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
                options = options || {};
                <span class="hljs-keyword">this</span>._ensureOptions(options);
                <span class="hljs-keyword">this</span>._app = options.app;
                <span class="hljs-keyword">this</span>.region = options.region;
                <span class="hljs-keyword">this</span>.service = options.service;
                <span class="hljs-keyword">this</span>.context = {};
                <span class="hljs-keyword">this</span>.components = {};
                Jskeleton.LayoutView.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            },
            _ensureOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
                <span class="hljs-keyword">if</span> (!options.app) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener la referencia a su application'</span>);
                }
                <span class="hljs-keyword">if</span> (!options.channel) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener un canal'</span>);
                }
                <span class="hljs-keyword">if</span> (!options.region) { <span class="hljs-comment">// mirarlo</span>
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener una region específica'</span>);
                }
            },</pre></div></div>

        </li>


        <li id="section-121">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>expose application enviroment, ViewController context and <code>Marionette.templateHelpers</code> to the view-controller template</p>

            </div>

            <div class="content"><div class='highlight'><pre>            mixinTemplateHelpers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(target)</span> </span>{
                target = target || {};
                <span class="hljs-keyword">var</span> templateHelpers = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'templateHelpers'</span>);

                templateHelpers = Marionette._getValue(templateHelpers, <span class="hljs-keyword">this</span>);


                <span class="hljs-keyword">var</span> templateContext = {
                    enviroment: {
                        _app: <span class="hljs-keyword">this</span>._app,
                        _view: <span class="hljs-keyword">this</span>,
                        _channel: <span class="hljs-keyword">this</span>.channel
                    },
                    templateHelpers: templateHelpers,
                    context: <span class="hljs-keyword">this</span>.context, <span class="hljs-comment">// TODO: Mirar bien</span>
                    serializedData: target
                };

                <span class="hljs-keyword">return</span> templateContext;
            },
            addComponent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, instance)</span> </span>{
                <span class="hljs-keyword">this</span>.components[name] = <span class="hljs-keyword">this</span>.components[name] || [];
                <span class="hljs-keyword">this</span>.components[name].push(instance);
            },
            _destroyComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> component;

                _.each(<span class="hljs-keyword">this</span>.components, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(componentArray)</span> </span>{
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; componentArray.length; i++) {
                        component = componentArray[i];

                        <span class="hljs-keyword">if</span> (component &amp;&amp; _.isFunction(component.destroy)) {
                            component.destroy();
                        }

                        <span class="hljs-keyword">delete</span> componentArray[i];
                    }
                });
            },</pre></div></div>

        </li>


        <li id="section-122">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Override Marionette._delegateDOMEvents to add Components listeners</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _delegateDOMEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventsArg)</span> </span>{
                <span class="hljs-keyword">var</span> events = Marionette._getValue(eventsArg || <span class="hljs-keyword">this</span>.events, <span class="hljs-keyword">this</span>),
                    componentEvents = Jskeleton.utils.extractComponentEvents(events);

                events = _.omit(events, _.keys(componentEvents));

                <span class="hljs-keyword">this</span>._componentEvents = componentEvents;


                <span class="hljs-keyword">return</span> Marionette.View.prototype._delegateDOMEvents.call(<span class="hljs-keyword">this</span>, events);
            },</pre></div></div>

        </li>


        <li id="section-123">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>Bind event to the specified component using listenTo method</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _delegateComponentEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component, event, handlerName)</span> </span>{
                <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>[handlerName];

                <span class="hljs-keyword">if</span> (!handler || <span class="hljs-keyword">typeof</span> handler !== <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un método valido como handler del evento de la vista'</span>);
                }

                <span class="hljs-keyword">if</span> (component &amp;&amp; component.isDestroyed !== <span class="hljs-literal">true</span>) {
                    <span class="hljs-keyword">this</span>.listenTo(component, event, handler);
                }
            },</pre></div></div>

        </li>


        <li id="section-124">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Bind off event to the specified component using off method</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _undelegateComponentEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component, event, handler)</span> </span>{
                <span class="hljs-keyword">this</span>.off(event, handler);
            },
            unbindComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    components = <span class="hljs-keyword">this</span>.components;

                _.each(<span class="hljs-keyword">this</span>._componentEvents, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, eventName)</span> </span>{
                    <span class="hljs-keyword">var</span> componentName = Jskeleton.utils.normalizeComponentName(eventName),
                        eventType = Jskeleton.utils.normailzeEventType(eventName),
                        componentArray = components[componentName];

                    _.each(componentArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component)</span> </span>{

                        self._undelegateComponentEvent(component, eventType, method);

                    });
                });
            },</pre></div></div>

        </li>


        <li id="section-125">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>Attach events to the controller-view components to listenTo those events with <code>@component.ComponentName</code> event notation</p>

            </div>

            <div class="content"><div class='highlight'><pre>            bindComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    components = <span class="hljs-keyword">this</span>.components;

                _.each(<span class="hljs-keyword">this</span>._componentEvents, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-126">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>Get component name from event hash <code>@component.ComponentName</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">var</span> componentName = Jskeleton.utils.normalizeComponentName(eventName),</pre></div></div>

        </li>


        <li id="section-127">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Get event name from event hash <code>click @component.ComponentName</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>                        eventType = Jskeleton.utils.normailzeEventType(eventName),</pre></div></div>

        </li>


        <li id="section-128">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>Get the component instance by component name</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        componentArray = components[componentName];

                    _.each(componentArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component)</span> </span>{
                        self._delegateComponentEvent(component, eventType, method);
                    });
                });
            },
            render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>._destroyComponents();

                Jskeleton.LayoutView.prototype.render.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

                <span class="hljs-keyword">this</span>.unbindComponents();
                <span class="hljs-keyword">this</span>.bindComponents();

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
            },
            destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>._destroyComponents();
                <span class="hljs-keyword">return</span> Marionette.LayoutView.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
        });



    <span class="hljs-keyword">return</span> Jskeleton;

});</pre></div></div>

        </li>

    </ul>
  </div>
